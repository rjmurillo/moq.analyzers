# Moq1600: Avoid complex expressions in Mock.Of

| Item     | Value   |
| -------- | ------- |
| Enabled  | True    |
| Severity | Warning |
| CodeFix  | True    |
---

Mock.Of is designed for simple property setups. Complex expressions involving method calls, nested Mock.Of patterns, or intricate logic may not work as expected and can lead to confusing behavior. Use standard Mock setup methods for complex scenarios.

## Examples of patterns that are flagged by this analyzer

```csharp
public interface IRepository
{
    bool IsAuthenticated { get; }
    string GetData(int id);
}

// Complex expression with method call
var mock = Mock.Of<IRepository>(r => 
    r.IsAuthenticated == true && 
    r.GetData(It.IsAny<int>()) == "test"); // Moq1600: Avoid complex expressions in Mock.Of
```

```csharp
public interface IRepository
{
    string GetData(int id);
}

// Nested Mock.Of patterns
var mock = Mock.Of<IRepository>(r =>
    r.GetData(1) == Mock.Of<IRepository>(inner => 
        inner.GetData(2) == "nested").GetData(2)); // Moq1600: Avoid complex expressions in Mock.Of
```

## Solution

Use simple property assignments in Mock.Of, or use standard Mock setup for complex scenarios:

```csharp
public interface IRepository
{
    bool IsAuthenticated { get; }
    string GetData(int id);
}

// Good: Simple property setup
var simpleMock = Mock.Of<IRepository>(r => r.IsAuthenticated == true);

// Good: Use standard Mock for complex scenarios
var mock = new Mock<IRepository>();
mock.Setup(r => r.IsAuthenticated).Returns(true);
mock.Setup(r => r.GetData(It.IsAny<int>())).Returns("test");
```

## Suppress a warning

If you just want to suppress a single violation, add preprocessor directives to
your source file to disable and then re-enable the rule.

```csharp
#pragma warning disable Moq1600
var mock = Mock.Of<IRepository>(r => r.GetData(It.IsAny<int>()) == "test"); // Moq1600: Avoid complex expressions in Mock.Of
#pragma warning restore Moq1600
```

To disable the rule for a file, folder, or project, set its severity to `none`
in the
[configuration file](https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/configuration-files).

```ini
[*.{cs,vb}]
dotnet_diagnostic.Moq1600.severity = none
```

For more information, see
[How to suppress code analysis warnings](https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/suppress-warnings).
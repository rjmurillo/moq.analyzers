# Moq1210: Verify should be used only for overridable members

| Item     | Value |
| -------- | ----- |
| Enabled  | True  |
| Severity | Error |
| CodeFix  | False |
---

Mocking requires generating a subclass of the class to be mocked. Methods not marked `virtual` cannot be overridden, and thus cannot be verified.
To fix:

- Mock an interface instead of a class
- Make the method to be verified `virtual`

```csharp
class SampleClass
{
    int Property { get; set; }
    int NonVirtualMethod() => 0;
}

var mock = new Mock<SampleClass>();
mock.Verify(x => x.Property);         // Moq1210: Verify should be used only for overridable members
mock.Verify(x => x.NonVirtualMethod()); // Moq1210: Verify should be used only for overridable members
mock.VerifyGet(x => x.Property);      // Moq1210: Verify should be used only for overridable members
mock.VerifySet(x => x.Property = 42); // Moq1210: Verify should be used only for overridable members
```

## Solution

```csharp
class SampleClass
{
    virtual int Property { get; set; }
    virtual int VirtualMethod() => 0;
}

var mock = new Mock<SampleClass>();
mock.Verify(x => x.Property);
mock.Verify(x => x.VirtualMethod());
mock.VerifyGet(x => x.Property);
mock.VerifySet(x => x.Property = 42);
mock.VerifyNoOtherCalls(); // This method doesn't verify specific members, so it's always valid
```

## Suppress a warning

If you just want to suppress a single violation, add preprocessor directives to
your source file to disable and then re-enable the rule.

```csharp
#pragma warning disable Moq1210
mock.Verify(x => x.Property); // Moq1210: Verify should be used only for overridable members
#pragma warning restore Moq1210
```

To disable the rule for a file, folder, or project, set its severity to `none`
in the
[configuration file](https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/configuration-files).

```ini
[*.{cs,vb}]
dotnet_diagnostic.Moq1210.severity = none
```

For more information, see
[How to suppress code analysis warnings](https://learn.microsoft.com/en-us/dotnet/fundamentals/code-analysis/suppress-warnings).